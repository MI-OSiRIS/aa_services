# OSiRIS LDAP Schema Extensions
# based on the mg2.org OID namespace 1.3.5.1.3.1.17128
# sliced off .313 for OSiRIS attributes

#
# Topology...
# ou=People, dc=osris, dc=org - (osirisPerson, eduPerson, posixUser) people
# ou=Automata, dc=osris, dc=org - (osirisAutomaton, eduPerson, posixUser) robots, daemon users
# ou=Authorities, dc=osris, dc=org - (osirisResourceAuthority, osirisCentralAuthority), central & resource
#     authorities
# ou=Organizations, dc=osris, dc=org - (osirisOrganization), osiris organizations, these can be affiliated
#     with many EduOrgs via the osirisOrganizationalAffiliations attribute
# ou=EduOrgs, dc=osris, dc=org - organizations - (osirisEduOrg, eduOrg) organizations that adhere
#     closely to the EduOrg schema, and represent one organization
# ou=Projects, dc=osris, dc=org - (osirisProject) osiris projects
# ou=Groups, dc=osris, dc=org - (osirisGroup, posixGroup) osiris groups
#

# Attributes
attributeType ( 1.3.5.1.3.1.17128.313.1.1
    NAME 'osirisKeyThumbprint',
    DESC 'a Base64-URL encoded SHA256 hash of the DER encoded RSA signing public key'
    EQUALITY caseExactMatch
    SINGLE_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.2
    NAME ('oeui' 'osirisEntityUniqueID')
    DESC 'a UUID uniquely identifying an OSiRIS entity, generated by oakd'
    EQUALITY caseIgnoreMatch
    SINGLE_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.3
    NAME 'osirisOakEndpoint'
    DESC 'full URL of the OAK (OAA keyring service) endpoint'
    EQUALITY caseIgnoreMatch
    SINGLE_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.4
    NAME 'osirisStpEndpoint'
    DESC 'full URL of the STP (OAA to native gateway service) endpoint'
    EQUALITY caseIgnoreMatch
    SINGLE_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.5
    NAME 'osirisEncryptionCertificate'
    DESC 'a DER encoded encryption certificate'
    EQUALITY caseExactMatch
    SINGLE_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.6
    NAME 'osirisSigningCertificate'
    DESC 'a DER encoded signing certificate'
    EQUALITY caseExactMatch
    SINGLE_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.7
    NAME 'osirisAccessTokens'
    DESC 'an entitys current set of issued b64u encoded OATs'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.8
    NAME 'osirisPreviousEncryptionCertificates'
    DESC 'all historical DER encoded encryption certificates for this entity'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.9
    NAME 'osirisPreviousSigningCertificates'
    DESC 'all historical DER encoded signing certificates for this entity'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.10
    NAME 'osirisCILogonMapString',
    DESC 'map string used for CILogon integration with Globus',
    EQUALITY caseExactIA5Match
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15
    X-ORIGIN 'http://www.osris.org/'
)

attributeType(1.3.5.1.3.1.17128.313.1.11
    NAME 'osirisAssociatedCOs',
    DESC 'place to store the unique ids of the COs this entity is associated with',
    EQUALITY caseExactIA5Match
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15
    X-ORIGIN 'http://www.osris.org/'
)

attributeType(1.3.5.1.3.1.17128.313.1.12
    NAME 'osirisAssociatedCOGroups',
    DESC 'place to store the unique of the CO-Groups this entity is associated with',
    EQUALITY caseExactIA5Match
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15
    X-ORIGIN 'http://www.osris.org/'
)

attributeType(1.3.5.1.3.1.17128.313.1.13
    NAME 'osirisProjectAffiliations',
    DESC 'the DNs of the osirisProjects this entity is affiliated with'
    EQUALITY caseIgnoreMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.12
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.14
    NAME 'osirisRefreshTokens'
    DESC 'an entitys current set of issued and valid b64u encoded ORTs'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'   
)

attributeType (1.3.5.1.3.1.17128.313.1.15
    NAME 'osirisAccessRequests'
    DESC 'an entitys current set of issued and valid b64u encoded OARs'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)
  
attributeType (1.3.5.1.3.1.17128.313.1.16
    NAME 'osirisAccessGrants'
    DESC 'an entitys current set of issued and valid b64u encoded OAGs'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.17
    NAME 'osirisAccessAssertions'
    DESC 'an entitys current set of issued and valid b64u encoded OAAs'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.18
    NAME 'osirisInvalidAccessAssertions'
    DESC 'an entitys set of invalid, expired, or revoked b64u encoded OAAs'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.19
    NAME 'osirisPendingAccessRequests'
    DESC 'a set of pending b64u encoded OARs'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'   
)

attributeType (1.3.5.1.3.1.17128.313.1.20
    NAME 'osirisPendingAccessGrants'
    DESC 'a set of pending b64u encoded OAGs'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType (1.3.5.1.3.1.17128.313.1.21
    NAME 'osirisPendingAccessAssertions'
    DESC 'a set of pending b64u encoded OAAs'
    EQUALITY caseExactMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
    X-ORIGIN 'http://www.osris.org/'
)

attributeType(1.3.5.1.3.1.17128.313.1.22
    NAME 'osirisProjectAffiliates',
    DESC 'the DNs of the people, automata, or organizations this osirisProject is affiliated with'
    EQUALITY caseIgnoreMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.12
    X-ORIGIN 'http://www.osris.org/'
)

attributeType(1.3.5.1.3.1.17128.313.1.23
    NAME 'osirisOrganizationalAffiliations',
    DESC 'the DNs of organizations this entity is affiliated with'
    EQUALITY caseIgnoreMatch
    MULTI_VALUE
    SYNTAX 1.3.6.1.4.1.1466.115.121.1.12
    X-ORIGIN 'http://www.osris.org/'
)

# Object Classes
objectClass ( 1.3.5.1.3.1.17128.313.1
    NAME 'osirisEntity' SUP top STRUCTURAL
    MUST ( osirisEntityUniqueID $ cn )
    MAY (
        description $ uid $ mail $ ou $ telephoneNumber $
        osirisPreviousSigningCertificates $ osirisPreviousEncryptionCertificates $
        osirisAssociatedCOs $ osirisAssociatedCOGroups $ osirisCILogonMapString $
        osirisKeyThumbprint $ osirisEncryptionCertificate $ osirisSigningCertificate $
        osirisAccessTokens $ osirisRefreshTokens $ osirisAccessRequests $ osirisAccessGrants $
        osirisAccessAssertions
    )
)

objectClass ( 1.3.5.1.3.1.17128.313.2
    NAME 'osirisResourceAuthority' SUP osirisEntity STRUCTURAL
    MUST ( osirisKeyThumbprint $ osirisSigningCertificate $ osirisEncryptionCertificate $ osirisStpEndpoint )
    MAY ( osirisPendingAccessRequests $ osirisPendingAccessGrants $ osirisPendingAccessAssertions )
)

objectClass ( 1.3.5.1.3.1.17128.313.3
    NAME 'osirisCentralAuthority' SUP osirisEntity STRUCTURAL
    MUST ( osirisKeyThumbprint $ osirisOakEndpoint $ osirisSigningCertificate $ osirisEncryptionCertificate )
    MAY ( osirisPendingAccessRequests $ osirisPendingAccessGrants $ osirisPendingAccessAssertions )
)

objectClass ( 1.3.5.1.3.1.17128.313.4
    NAME 'osirisGroup' SUP groupOfNames STRUCTURAL
    DESC 'groups of osirisEntity objects'
    MUST ( cn $ osirisEntityUniqueID )
    MAY ( description $ member $ osirisAssociatedCOs $ osirisAssociatedCOGroups )
)

objectClass ( 1.3.5.1.3.1.17128.313.5
    NAME 'osirisPerson' SUP osirisEntity STRUCTURAL
    DESC 'a person who is a user of OSiRIS systems'
    MUST ( sn $ givenName $ eduPersonPrincipalName $ osirisOrganizationalAffiliations $ uid $ userPassword $ mail )
    MAY ( osirisProjectAffiliations $ osirisOrganizationalAffiliations )
)

objectClass ( 1.3.5.1.3.1.17128.313.6
    NAME 'osirisProject' SUP osirisEntity STRUCTURAL
    DESC 'a project or science domain within the OSiRIS system'
    MUST ( osirisGroup $ cn $ osirisOrganizationalAffiliations )
    MAY ( osirisProjectAffiliates )
)

objectClass (1.3.5.1.3.1.17128.313.7
    NAME 'osirisOrganization' SUP osirisEntity STRUCTURAL
    DESC 'an organization affiliated with OSiRIS'
    MUST ( mailAccessDomain $ eduPersonOrgDN )
    MAY ( osirisProjectAffiliations $ osirisOrganizationalAffiliations )
)

objectClass (1.3.5.1.3.1.17128.313.8
    NAME 'osirisAutomaton' SUP osirisEntity STRUCTURAL
    DESC 'a robot who is a user of OSiRIS systems'
    MUST ( cn $ uid )
    MAY ( osirisProjectAffiliations $ osirisOrganizationalAffiliations $ userPassword )
)

objectClass (1.3.5.1.3.1.17128.313.9
    NAME 'osirisEduOrg' SUP osirisEntity STRUCTURAL
    DESC 'an organization that represents a single EduOrg organizations'
    MUST ( cn $ uid $ userPassword )
    MAY ( osirisProjectAffiliations $ osirisOrganizationalAffiliations )
)
